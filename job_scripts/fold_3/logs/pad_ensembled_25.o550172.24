Loading tensorflow/1.12
  Loading requirement: cuda/10.0 cudnn/7.4
2019-11-15 11:50:54.290005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX TITAN X major: 5 minor: 2 memoryClockRate(GHz): 1.076
pciBusID: 0000:82:00.0
totalMemory: 11.93GiB freeMemory: 2.73GiB
2019-11-15 11:50:54.290085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-11-15 11:50:54.768269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-11-15 11:50:54.768396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-11-15 11:50:54.768422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-11-15 11:50:54.768585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2431 MB memory) -> physical GPU (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:82:00.0, compute capability: 5.2)
2019-11-15 11:51:17.403366: W tensorflow/core/common_runtime/bfc_allocator.cc:267] Allocator (GPU_0_bfc) ran out of memory trying to allocate 900.00MiB.  Current allocation summary follows.
2019-11-15 11:51:17.403495: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (256): 	Total Chunks: 10, Chunks in use: 10. 2.5KiB allocated for chunks. 2.5KiB in use in bin. 260B client-requested in use in bin.
2019-11-15 11:51:17.403516: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (512): 	Total Chunks: 5, Chunks in use: 5. 2.5KiB allocated for chunks. 2.5KiB in use in bin. 1.9KiB client-requested in use in bin.
2019-11-15 11:51:17.403533: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (1024): 	Total Chunks: 19, Chunks in use: 19. 23.8KiB allocated for chunks. 23.8KiB in use in bin. 23.5KiB client-requested in use in bin.
2019-11-15 11:51:17.403547: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403560: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403573: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403587: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (16384): 	Total Chunks: 7, Chunks in use: 7. 112.0KiB allocated for chunks. 112.0KiB in use in bin. 112.0KiB client-requested in use in bin.
2019-11-15 11:51:17.403601: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403614: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403627: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (131072): 	Total Chunks: 5, Chunks in use: 5. 1.05MiB allocated for chunks. 1.05MiB in use in bin. 1.05MiB client-requested in use in bin.
2019-11-15 11:51:17.403641: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403653: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403667: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (1048576): 	Total Chunks: 4, Chunks in use: 4. 6.00MiB allocated for chunks. 6.00MiB in use in bin. 6.00MiB client-requested in use in bin.
2019-11-15 11:51:17.403682: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (2097152): 	Total Chunks: 8, Chunks in use: 8. 27.00MiB allocated for chunks. 27.00MiB in use in bin. 27.00MiB client-requested in use in bin.
2019-11-15 11:51:17.403711: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (4194304): 	Total Chunks: 4, Chunks in use: 4. 20.25MiB allocated for chunks. 20.25MiB in use in bin. 20.25MiB client-requested in use in bin.
2019-11-15 11:51:17.403726: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403739: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403751: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403766: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (67108864): 	Total Chunks: 1, Chunks in use: 1. 64.00MiB allocated for chunks. 64.00MiB in use in bin. 64.00MiB client-requested in use in bin.
2019-11-15 11:51:17.403779: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:17.403793: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (268435456): 	Total Chunks: 3, Chunks in use: 2. 2.26GiB allocated for chunks. 1.76GiB in use in bin. 1.76GiB client-requested in use in bin.
2019-11-15 11:51:17.403806: I tensorflow/core/common_runtime/bfc_allocator.cc:613] Bin for 900.00MiB was 256.00MiB, Chunk State: 
2019-11-15 11:51:17.403826: I tensorflow/core/common_runtime/bfc_allocator.cc:619]   Size: 513.38MiB | Requested Size: 0B | in_use: 0, prev:   Size: 900.00MiB | Requested Size: 900.00MiB | in_use: 1
2019-11-15 11:51:17.403844: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940000 of size 256
2019-11-15 11:51:17.403857: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940100 of size 256
2019-11-15 11:51:17.403868: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940200 of size 512
2019-11-15 11:51:17.403880: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940400 of size 512
2019-11-15 11:51:17.403892: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940600 of size 1024
2019-11-15 11:51:17.403903: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940a00 of size 1536
2019-11-15 11:51:17.403930: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306941000 of size 1536
2019-11-15 11:51:17.403945: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306941600 of size 1536
2019-11-15 11:51:17.403956: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306941c00 of size 1024
2019-11-15 11:51:17.403967: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306942000 of size 1024
2019-11-15 11:51:17.403979: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306942400 of size 225792
2019-11-15 11:51:17.403990: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306979600 of size 1572864
2019-11-15 11:51:17.404002: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306af9600 of size 3538944
2019-11-15 11:51:17.404014: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306e59600 of size 5308416
2019-11-15 11:51:17.404026: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1307369600 of size 3538944
2019-11-15 11:51:17.404038: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076c9600 of size 16384
2019-11-15 11:51:17.404049: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076cd600 of size 256
2019-11-15 11:51:17.404061: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076cd700 of size 256
2019-11-15 11:51:17.404082: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076cd800 of size 943718400
2019-11-15 11:51:17.404095: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x133facd800 of size 67108864
2019-11-15 11:51:17.404108: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343acd800 of size 196608
2019-11-15 11:51:17.404119: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afd800 of size 256
2019-11-15 11:51:17.404131: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afd900 of size 1280
2019-11-15 11:51:17.404142: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afde00 of size 256
2019-11-15 11:51:17.404154: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afdf00 of size 256
2019-11-15 11:51:17.404165: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe000 of size 512
2019-11-15 11:51:17.404177: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe200 of size 512
2019-11-15 11:51:17.404188: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe400 of size 512
2019-11-15 11:51:17.404199: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe600 of size 1024
2019-11-15 11:51:17.404210: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afea00 of size 1024
2019-11-15 11:51:17.404221: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afee00 of size 1536
2019-11-15 11:51:17.404232: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343aff400 of size 1536
2019-11-15 11:51:17.404243: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343affa00 of size 1536
2019-11-15 11:51:17.404255: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b00000 of size 1536
2019-11-15 11:51:17.404266: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b00600 of size 1536
2019-11-15 11:51:17.404277: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b00c00 of size 1536
2019-11-15 11:51:17.404288: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01200 of size 1024
2019-11-15 11:51:17.404299: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01600 of size 1024
2019-11-15 11:51:17.404310: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01a00 of size 1024
2019-11-15 11:51:17.404321: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01e00 of size 1024
2019-11-15 11:51:17.404333: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b02200 of size 225792
2019-11-15 11:51:17.404344: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b39400 of size 225792
2019-11-15 11:51:17.404355: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b70600 of size 225792
2019-11-15 11:51:17.404366: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343ba7800 of size 1572864
2019-11-15 11:51:17.404377: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343d27800 of size 1572864
2019-11-15 11:51:17.404389: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343ea7800 of size 1572864
2019-11-15 11:51:17.404400: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344027800 of size 3538944
2019-11-15 11:51:17.404411: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344387800 of size 3538944
2019-11-15 11:51:17.404422: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13446e7800 of size 3538944
2019-11-15 11:51:17.404433: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344a47800 of size 5308416
2019-11-15 11:51:17.404445: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344f57800 of size 5308416
2019-11-15 11:51:17.404456: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1345467800 of size 5308416
2019-11-15 11:51:17.404475: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1345977800 of size 3538944
2019-11-15 11:51:17.404487: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1345cd7800 of size 3538944
2019-11-15 11:51:17.404499: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1346037800 of size 3538944
2019-11-15 11:51:17.404510: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1346397800 of size 16384
2019-11-15 11:51:17.404521: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x134639b800 of size 16384
2019-11-15 11:51:17.404532: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x134639f800 of size 16384
2019-11-15 11:51:17.404543: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463a3800 of size 16384
2019-11-15 11:51:17.404555: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463a7800 of size 16384
2019-11-15 11:51:17.404566: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463ab800 of size 16384
2019-11-15 11:51:17.404577: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463af800 of size 256
2019-11-15 11:51:17.404588: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463af900 of size 256
2019-11-15 11:51:17.404599: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463afa00 of size 256
2019-11-15 11:51:17.404610: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463afb00 of size 943718400
2019-11-15 11:51:17.404622: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Free  at 0x137e7afb00 of size 538313984
2019-11-15 11:51:17.404632: I tensorflow/core/common_runtime/bfc_allocator.cc:638]      Summary of in-use Chunks by size: 
2019-11-15 11:51:17.404647: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 10 Chunks of size 256 totalling 2.5KiB
2019-11-15 11:51:17.404660: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 5 Chunks of size 512 totalling 2.5KiB
2019-11-15 11:51:17.404673: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 9 Chunks of size 1024 totalling 9.0KiB
2019-11-15 11:51:17.404686: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 1280 totalling 1.2KiB
2019-11-15 11:51:17.404699: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 9 Chunks of size 1536 totalling 13.5KiB
2019-11-15 11:51:17.404712: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 7 Chunks of size 16384 totalling 112.0KiB
2019-11-15 11:51:17.404726: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 196608 totalling 192.0KiB
2019-11-15 11:51:17.404739: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 225792 totalling 882.0KiB
2019-11-15 11:51:17.404752: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 1572864 totalling 6.00MiB
2019-11-15 11:51:17.404765: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 8 Chunks of size 3538944 totalling 27.00MiB
2019-11-15 11:51:17.404778: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 5308416 totalling 20.25MiB
2019-11-15 11:51:17.404792: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 67108864 totalling 64.00MiB
2019-11-15 11:51:17.404804: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 2 Chunks of size 943718400 totalling 1.76GiB
2019-11-15 11:51:17.404817: I tensorflow/core/common_runtime/bfc_allocator.cc:645] Sum Total of in-use chunks: 1.87GiB
2019-11-15 11:51:17.404832: I tensorflow/core/common_runtime/bfc_allocator.cc:647] Stats: 
Limit:                  2549940224
InUse:                  2011626240
MaxInUse:               2011626240
NumAllocs:                      65
MaxAllocSize:            943718400

2019-11-15 11:51:17.404848: W tensorflow/core/common_runtime/bfc_allocator.cc:271] *******************************************************************************_____________________
2019-11-15 11:51:17.404888: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at assign_op.h:117 : Resource exhausted: OOM when allocating tensor with shape[57600,4096] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
2019-11-15 11:51:27.405127: W tensorflow/core/common_runtime/bfc_allocator.cc:267] Allocator (GPU_0_bfc) ran out of memory trying to allocate 900.00MiB.  Current allocation summary follows.
2019-11-15 11:51:27.405222: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (256): 	Total Chunks: 10, Chunks in use: 10. 2.5KiB allocated for chunks. 2.5KiB in use in bin. 260B client-requested in use in bin.
2019-11-15 11:51:27.405259: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (512): 	Total Chunks: 5, Chunks in use: 5. 2.5KiB allocated for chunks. 2.5KiB in use in bin. 1.9KiB client-requested in use in bin.
2019-11-15 11:51:27.405292: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (1024): 	Total Chunks: 19, Chunks in use: 19. 23.8KiB allocated for chunks. 23.8KiB in use in bin. 23.5KiB client-requested in use in bin.
2019-11-15 11:51:27.405321: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405349: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405376: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405407: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (16384): 	Total Chunks: 7, Chunks in use: 7. 112.0KiB allocated for chunks. 112.0KiB in use in bin. 112.0KiB client-requested in use in bin.
2019-11-15 11:51:27.405435: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405462: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405491: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (131072): 	Total Chunks: 5, Chunks in use: 5. 1.05MiB allocated for chunks. 1.05MiB in use in bin. 1.05MiB client-requested in use in bin.
2019-11-15 11:51:27.405519: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405546: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405578: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (1048576): 	Total Chunks: 4, Chunks in use: 4. 6.00MiB allocated for chunks. 6.00MiB in use in bin. 6.00MiB client-requested in use in bin.
2019-11-15 11:51:27.405609: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (2097152): 	Total Chunks: 8, Chunks in use: 8. 27.00MiB allocated for chunks. 27.00MiB in use in bin. 27.00MiB client-requested in use in bin.
2019-11-15 11:51:27.405641: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (4194304): 	Total Chunks: 4, Chunks in use: 4. 20.25MiB allocated for chunks. 20.25MiB in use in bin. 20.25MiB client-requested in use in bin.
2019-11-15 11:51:27.405669: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405697: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405744: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405775: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (67108864): 	Total Chunks: 1, Chunks in use: 1. 64.00MiB allocated for chunks. 64.00MiB in use in bin. 64.00MiB client-requested in use in bin.
2019-11-15 11:51:27.405803: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-11-15 11:51:27.405832: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (268435456): 	Total Chunks: 3, Chunks in use: 2. 2.26GiB allocated for chunks. 1.76GiB in use in bin. 1.76GiB client-requested in use in bin.
2019-11-15 11:51:27.405861: I tensorflow/core/common_runtime/bfc_allocator.cc:613] Bin for 900.00MiB was 256.00MiB, Chunk State: 
2019-11-15 11:51:27.405897: I tensorflow/core/common_runtime/bfc_allocator.cc:619]   Size: 513.38MiB | Requested Size: 0B | in_use: 0, prev:   Size: 900.00MiB | Requested Size: 900.00MiB | in_use: 1
2019-11-15 11:51:27.405957: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940000 of size 256
2019-11-15 11:51:27.405994: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940100 of size 256
2019-11-15 11:51:27.406017: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940200 of size 512
2019-11-15 11:51:27.406039: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940400 of size 512
2019-11-15 11:51:27.406061: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940600 of size 1024
2019-11-15 11:51:27.406084: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306940a00 of size 1536
2019-11-15 11:51:27.406107: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306941000 of size 1536
2019-11-15 11:51:27.406129: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306941600 of size 1536
2019-11-15 11:51:27.406150: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306941c00 of size 1024
2019-11-15 11:51:27.406172: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306942000 of size 1024
2019-11-15 11:51:27.406194: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306942400 of size 225792
2019-11-15 11:51:27.406217: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306979600 of size 1572864
2019-11-15 11:51:27.406240: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306af9600 of size 3538944
2019-11-15 11:51:27.406263: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1306e59600 of size 5308416
2019-11-15 11:51:27.406286: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1307369600 of size 3538944
2019-11-15 11:51:27.406309: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076c9600 of size 16384
2019-11-15 11:51:27.406331: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076cd600 of size 256
2019-11-15 11:51:27.406353: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076cd700 of size 256
2019-11-15 11:51:27.406375: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13076cd800 of size 943718400
2019-11-15 11:51:27.406398: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x133facd800 of size 67108864
2019-11-15 11:51:27.406421: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343acd800 of size 196608
2019-11-15 11:51:27.406444: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afd800 of size 256
2019-11-15 11:51:27.406467: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afd900 of size 1280
2019-11-15 11:51:27.406489: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afde00 of size 256
2019-11-15 11:51:27.406511: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afdf00 of size 256
2019-11-15 11:51:27.406547: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe000 of size 512
2019-11-15 11:51:27.406570: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe200 of size 512
2019-11-15 11:51:27.406591: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe400 of size 512
2019-11-15 11:51:27.406613: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afe600 of size 1024
2019-11-15 11:51:27.406634: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afea00 of size 1024
2019-11-15 11:51:27.406656: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343afee00 of size 1536
2019-11-15 11:51:27.406678: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343aff400 of size 1536
2019-11-15 11:51:27.406699: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343affa00 of size 1536
2019-11-15 11:51:27.406721: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b00000 of size 1536
2019-11-15 11:51:27.406743: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b00600 of size 1536
2019-11-15 11:51:27.406764: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b00c00 of size 1536
2019-11-15 11:51:27.406786: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01200 of size 1024
2019-11-15 11:51:27.406808: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01600 of size 1024
2019-11-15 11:51:27.406830: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01a00 of size 1024
2019-11-15 11:51:27.406852: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b01e00 of size 1024
2019-11-15 11:51:27.406874: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b02200 of size 225792
2019-11-15 11:51:27.406896: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b39400 of size 225792
2019-11-15 11:51:27.406930: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343b70600 of size 225792
2019-11-15 11:51:27.406955: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343ba7800 of size 1572864
2019-11-15 11:51:27.406977: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343d27800 of size 1572864
2019-11-15 11:51:27.406999: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1343ea7800 of size 1572864
2019-11-15 11:51:27.407021: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344027800 of size 3538944
2019-11-15 11:51:27.407043: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344387800 of size 3538944
2019-11-15 11:51:27.407065: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13446e7800 of size 3538944
2019-11-15 11:51:27.407087: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344a47800 of size 5308416
2019-11-15 11:51:27.407108: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1344f57800 of size 5308416
2019-11-15 11:51:27.407130: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1345467800 of size 5308416
2019-11-15 11:51:27.407152: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1345977800 of size 3538944
2019-11-15 11:51:27.407174: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1345cd7800 of size 3538944
2019-11-15 11:51:27.407195: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1346037800 of size 3538944
2019-11-15 11:51:27.407217: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x1346397800 of size 16384
2019-11-15 11:51:27.407239: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x134639b800 of size 16384
2019-11-15 11:51:27.407260: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x134639f800 of size 16384
2019-11-15 11:51:27.407282: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463a3800 of size 16384
2019-11-15 11:51:27.407317: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463a7800 of size 16384
2019-11-15 11:51:27.407340: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463ab800 of size 16384
2019-11-15 11:51:27.407362: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463af800 of size 256
2019-11-15 11:51:27.407384: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463af900 of size 256
2019-11-15 11:51:27.407405: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463afa00 of size 256
2019-11-15 11:51:27.407427: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x13463afb00 of size 943718400
2019-11-15 11:51:27.407450: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Free  at 0x137e7afb00 of size 538313984
2019-11-15 11:51:27.407471: I tensorflow/core/common_runtime/bfc_allocator.cc:638]      Summary of in-use Chunks by size: 
2019-11-15 11:51:27.407497: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 10 Chunks of size 256 totalling 2.5KiB
2019-11-15 11:51:27.407523: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 5 Chunks of size 512 totalling 2.5KiB
2019-11-15 11:51:27.407548: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 9 Chunks of size 1024 totalling 9.0KiB
2019-11-15 11:51:27.407572: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 1280 totalling 1.2KiB
2019-11-15 11:51:27.407598: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 9 Chunks of size 1536 totalling 13.5KiB
2019-11-15 11:51:27.407623: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 7 Chunks of size 16384 totalling 112.0KiB
2019-11-15 11:51:27.407648: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 196608 totalling 192.0KiB
2019-11-15 11:51:27.407673: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 225792 totalling 882.0KiB
2019-11-15 11:51:27.407698: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 1572864 totalling 6.00MiB
2019-11-15 11:51:27.407723: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 8 Chunks of size 3538944 totalling 27.00MiB
2019-11-15 11:51:27.407747: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 5308416 totalling 20.25MiB
2019-11-15 11:51:27.407772: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 67108864 totalling 64.00MiB
2019-11-15 11:51:27.407797: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 2 Chunks of size 943718400 totalling 1.76GiB
2019-11-15 11:51:27.407820: I tensorflow/core/common_runtime/bfc_allocator.cc:645] Sum Total of in-use chunks: 1.87GiB
2019-11-15 11:51:27.407848: I tensorflow/core/common_runtime/bfc_allocator.cc:647] Stats: 
Limit:                  2549940224
InUse:                  2011626240
MaxInUse:               2011626240
NumAllocs:                      65
MaxAllocSize:            943718400

2019-11-15 11:51:27.407878: W tensorflow/core/common_runtime/bfc_allocator.cc:271] *******************************************************************************_____________________
2019-11-15 11:51:27.407933: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at random_op.cc:202 : Resource exhausted: OOM when allocating tensor with shape[57600,4096] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
Image_batch-size: 32
Train size (216, 154587) (216, 12)
Test size (84, 154587) (84, 12)
(?, 15, 15, 256) 57600
Time taken for setup: 17.80534338951111
Traceback (most recent call last):
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1334, in _do_call
    return fn(*args)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1319, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1407, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[57600,4096] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[{{node fc_W1/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@fc_W1/Assign"], _grappler_relax_allocator_constraints=true, use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](fc_W1/Adam_1, fc_W1/Adam/Initializer/zeros)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 44, in <module>
    train.train(**d_params)
  File "/afs/crc.nd.edu/user/p/pmoreira/Private/pads_ensembled_test_v3/src/train.py", line 375, in train
    sess.run(init)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 929, in run
    run_metadata_ptr)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1328, in _do_run
    run_metadata)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1348, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[57600,4096] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node fc_W1/Adam_1/Assign (defined at /afs/crc.nd.edu/user/p/pmoreira/Private/pads_ensembled_test_v3/src/train.py:341)  = Assign[T=DT_FLOAT, _class=["loc:@fc_W1/Assign"], _grappler_relax_allocator_constraints=true, use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](fc_W1/Adam_1, fc_W1/Adam/Initializer/zeros)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


Caused by op 'fc_W1/Adam_1/Assign', defined at:
  File "main.py", line 44, in <module>
    train.train(**d_params)
  File "/afs/crc.nd.edu/user/p/pmoreira/Private/pads_ensembled_test_v3/src/train.py", line 341, in train
    optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(cost)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 410, in minimize
    name=name)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 593, in apply_gradients
    self._create_slots(var_list)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/training/adam.py", line 136, in _create_slots
    self._zeros_slot(v, "v", self._name)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/training/optimizer.py", line 1139, in _zeros_slot
    new_slot_variable = slot_creator.create_zeros_slot(var, op_name)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/training/slot_creator.py", line 183, in create_zeros_slot
    colocate_with_primary=colocate_with_primary)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/training/slot_creator.py", line 157, in create_slot_with_initializer
    dtype)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/training/slot_creator.py", line 65, in _create_slot_var
    validate_shape=validate_shape)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py", line 1487, in get_variable
    aggregation=aggregation)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py", line 1237, in get_variable
    aggregation=aggregation)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py", line 540, in get_variable
    aggregation=aggregation)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py", line 492, in _true_getter
    aggregation=aggregation)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py", line 922, in _get_single_variable
    aggregation=aggregation)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variables.py", line 183, in __call__
    return cls._variable_v1_call(*args, **kwargs)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variables.py", line 146, in _variable_v1_call
    aggregation=aggregation)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variables.py", line 125, in <lambda>
    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variable_scope.py", line 2444, in default_variable_creator
    expected_shape=expected_shape, import_scope=import_scope)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variables.py", line 187, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variables.py", line 1329, in __init__
    constraint=constraint)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/variables.py", line 1481, in _init_from_args
    validate_shape=validate_shape).op
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 221, in assign
    validate_shape=validate_shape)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 61, in assign
    use_locking=use_locking, name=name)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 488, in new_func
    return func(*args, **kwargs)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3274, in create_op
    op_def=op_def)
  File "/afs/crc.nd.edu/x86_64_linux/t/tensorflow/1.12/gpu/python3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1770, in __init__
    self._traceback = tf_stack.extract_stack()

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[57600,4096] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node fc_W1/Adam_1/Assign (defined at /afs/crc.nd.edu/user/p/pmoreira/Private/pads_ensembled_test_v3/src/train.py:341)  = Assign[T=DT_FLOAT, _class=["loc:@fc_W1/Assign"], _grappler_relax_allocator_constraints=true, use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](fc_W1/Adam_1, fc_W1/Adam/Initializer/zeros)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


